<!DOCTYPE html>
<html>
<!---
  Programmer : William McDonald
  Date modified : 09/26/18
--->
<head>
  <title> William McDonald | PicoCTF 2017 : Weird RSA </title>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://williammcdonald.github.io/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://williammcdonald.github.io/css/custom.min.css">
  <link rel="stylesheet" href="https://williammcdonald.github.io/css/nat.css">
  <script src="https://williammcdonald.github.io/js/jquery.min.js"></script>
  <script src="https://williammcdonald.github.io/js/bootstrap.min.js"></script>
  <script src="https://williammcdonald.github.io/js/scrollspy.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
  <script src="https://williammcdonald.github.io/js/jquery.js"></script>
</head>

<body>

  <div class="header"></div>

<!-- the web page layout -->
<div class="container-fluid text-center">
	<div class="row content">
        <!-- Left -->
		<div class="col-sm-2 sidenav">
      <div class="contact"></div>
		</div>
        <!-- Middle -->
		<div class="col-sm-8 text-center">
      <h3> Instructions </h3>
        <p> We recovered some <a href="https://williammcdonald.github.io/picoctf2017/Level2/problemFiles/WeirdRsa/RSA.txt" target=_blank>data</a>. It was labeled as RSA, but what in the world are "dq" and "dp"? Can you decrypt the ciphertext for us? </p>
      <h3> Hints </h3>
        <p> NO HINTS </p>
      <h3> Solution </h3>
        <p> At first, I was thrown through a loop, but after some quick wikepedia skimming, I came up with some basic python code: </p>
        <q>
          import binascii

          c = 95272795986475189505518980251137003509292621140166383887854853863720692420204142448424074834657149326853553097626486371206617513769930277580823116437975487148956107509247564965652417450550680181691869432067892028368985007229633943149091684419834136214793476910417359537696632874045272326665036717324623992885
          p = 11387480584909854985125335848240384226653929942757756384489381242206157197986555243995335158328781970310603060671486688856263776452654268043936036556215243
          q = 12972222875218086547425818961477257915105515705982283726851833508079600460542479267972050216838604649742870515200462359007315431848784163790312424462439629
          dp = 8191957726161111880866028229950166742224147653136894248088678244548815086744810656765529876284622829884409590596114090872889522887052772791407131880103961
          dq = 3570695757580148093370242608506191464756425954703930236924583065811730548932270595568088372441809535917032142349986828862994856575730078580414026791444659

          qinv = (1/q) % p
          m = pow(c, dq, q)
          print(m)
          message = binascii.unhexlify(format(m, 'x')).decode()
          print(message)
        </q>
    </div>
            <!-- Right -->
    <div class="col-sm-2 sidenav">
      <div class="education"></div>
    </div>
  </div>
</div>

<footer class="text-center">
  <div class="foot"></div>
</footer>

</body>
</html>
